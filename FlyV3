-- Fly Script | Toggle G
local player = game.Players.LocalPlayer
local mouse = player:GetMouse()
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local flying = false
local speed = 50

local bv, bg
local statusGui

-- Tạo chữ ĐANG BAY
local function createStatus()
    statusGui = Instance.new("ScreenGui", player.PlayerGui)
    statusGui.Name = "FlyStatus"

    local text = Instance.new("TextLabel", statusGui)
    text.Size = UDim2.new(0, 200, 0, 50)
    text.Position = UDim2.new(0.5, -100, 0.8, 0)
    text.BackgroundTransparency = 1
    text.Text = "✈️ ĐANG BAY"
    text.TextColor3 = Color3.fromRGB(0, 255, 255)
    text.TextScaled = true
    text.Font = Enum.Font.GothamBold
end

local function removeStatus()
    if statusGui then
        statusGui:Destroy()
        statusGui = nil
    end
end

local function startFly()
    local char = player.Character
    local hrp = char:WaitForChild("HumanoidRootPart")

    bv = Instance.new("BodyVelocity", hrp)
    bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    bv.Velocity = Vector3.zero

    bg = Instance.new("BodyGyro", hrp)
    bg.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
    bg.CFrame = hrp.CFrame

    createStatus()

    RunService.RenderStepped:Connect(function()
        if not flying then return end

        local cam = workspace.CurrentCamera
        bg.CFrame = cam.CFrame

        local move = Vector3.zero
        if UIS:IsKeyDown(Enum.KeyCode.W) then move += cam.CFrame.LookVector end
        if UIS:IsKeyDown(Enum.KeyCode.S) then move -= cam.CFrame.LookVector end
        if UIS:IsKeyDown(Enum.KeyCode.A) then move -= cam.CFrame.RightVector end
        if UIS:IsKeyDown(Enum.KeyCode.D) then move += cam.CFrame.RightVector end
        if UIS:IsKeyDown(Enum.KeyCode.Space) then move += cam.CFrame.UpVector end
        if UIS:IsKeyDown(Enum.KeyCode.LeftControl) then move -= cam.CFrame.UpVector end

        bv.Velocity = move * speed
    end)
end

local function stopFly()
    if bv then bv:Destroy() end
    if bg then bg:Destroy() end
    removeStatus()
end

-- Phím G bật/tắt bay
UIS.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == Enum.KeyCode.G then
        flying = not flying
        if flying then
            startFly()
        else
            stopFly()
        end
    end
end)
